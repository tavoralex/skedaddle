(this.webpackJsonpskedaddle=this.webpackJsonpskedaddle||[]).push([[0],{29:function(e,t,n){e.exports=n(47)},34:function(e,t,n){},37:function(e,t){function n(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}n.keys=function(){return[]},n.resolve=n,e.exports=n,n.id=37},47:function(e,t,n){"use strict";n.r(t);var r,i=n(0),a=n.n(i),o=n(24),c=n.n(o);n(34);!function(e){e.intro="intro",e.duel="duel",e.practice="practice",e.about="about",e.lobby="lobby"}(r||(r={}));var s=n(2),u=n(6),d=n(3);function l(){for(var e="0x",t=0;t<6;t++)e+="0123456789ABCDEF"[Math.floor(16*Math.random())];return e}function f(e){if(3!==e.length)return 0;var t=e[0],n=e[1],r=e[2],i=function(e){var t=Math.round(e).toString(16);return 1===t.length?"0"+t:t};return parseInt("".concat(i(t)).concat(i(n)).concat(i(r)),16)}function h(e){var t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e.toString(16));return t?{r:parseInt(t[1],16)||0,g:parseInt(t[2],16)||0,b:parseInt(t[3],16)||0}:{r:0,g:0,b:0}}function p(e,t,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?e+6*(t-e)*n:n<.5?t:n<2/3?e+(t-e)*(2/3-n)*6:e}function g(e,t,n){var r,i,a;if(0===t)r=i=a=n;else{var o=n<.5?n*(1+t):n+t-n*t,c=2*n-o;r=p(c,o,e+1/3),i=p(c,o,e),a=p(c,o,e-1/3)}return[255*r,255*i,255*a]}function b(e){for(var t=e.toString(16);t.length<6;)t="0"+t;return t="#"+t}var v=function(e){var t=Object(d.a)({width:"280px",height:"60px",backgroundColor:e.colors?e.colors.default:"#ffff80",display:"grid",transition:"all 0.15s ease-in"},e.style),n=Object(i.useState)(!1),r=Object(u.a)(n,2),o=r[0],c=r[1],s=Object(i.useState)(!1),l=Object(u.a)(s,2),f=l[0],h=l[1],p=Object(i.useState)(Object(d.a)({},t)),g=Object(u.a)(p,2),b=g[0],v=g[1],m=e.colors?e.colors.down:"green",y=e.colors?e.colors.hover:"lightgrey";Object(i.useEffect)((function(){e.disabled?v(Object(d.a)({},t,{color:"darkgrey",backgroundColor:"lightgrey",pointerEvents:"none"})):v(o?Object(d.a)({},t,{backgroundColor:m}):f?Object(d.a)({},t,{backgroundColor:y}):Object(d.a)({},t))}),[o,f,e.disabled]);return a.a.createElement("div",{onMouseEnter:function(){return h(!0)},onMouseLeave:function(){h(!1),c(!1)},onMouseDown:function(){return c(!0)},onMouseUp:function(){return c(!1)},onTouchStart:function(){return c(!0)},onTouchEnd:function(){return c(!1)},onClick:e.onClick,style:b},a.a.createElement("div",{style:Object(d.a)({color:"black",gridRow:1,gridColumn:1,alignSelf:"center",justifySelf:"center",fontWeight:600,fontSize:"16pt",padding:"8px",userSelect:"none"},e.textStyle)},e.title),e.children)},m=function(e){var t=e.data;return a.a.createElement("div",{style:{height:"".concat(window.innerHeight,"px"),width:"".concat(window.innerWidth,"px"),display:"grid",gridTemplateRows:"1fr 1fr 1fr",gridTemplateColumns:"1fr"}},a.a.createElement("div",{style:{gridRow:1,gridColumn:1,fontWeight:600,color:"red",fontSize:"32pt",alignSelf:"center",textAlign:"center"}},"GAME OVER"),a.a.createElement("div",{style:{gridRow:2,gridColumn:1,alignSelf:"center",justifySelf:"center"}},a.a.createElement(v,{title:"AGAIN!",onClick:function(){t.actions.startGame&&t.actions.startGame()}})),a.a.createElement("div",{style:{gridRow:3,gridColumn:1,alignSelf:"center",justifySelf:"center"}},a.a.createElement(v,{title:"BACK",onClick:function(){t.gameState=r.intro}})))},y=n(25),w={textShadow:"-1px -1px 0 #000,1px -1px 0 #000,-1px 1px 0 #000,1px 1px 0 #000",position:"fixed",fontSize:"34pt"},x=function(e){var t=e.data,n=Object(i.useState)(e.data.score.top),o=Object(u.a)(n,2),c=o[0],l=o[1],f=Object(i.useCallback)((function(){e.data.gameState=r.intro}),[]);Object(i.useEffect)((function(){return document.addEventListener("backbutton",f,!0),function(){document.removeEventListener("backbutton",f,!1)}}),[]),Object(i.useEffect)((function(){return Object(s.b)((function(){return l(e.data.score.top)}))}),[e.data.score.top]);var h=Object(i.useState)(e.data.fillbars.top/e.data.fillbars.max),p=Object(u.a)(h,2),g=p[0],x=p[1];Object(i.useEffect)((function(){return Object(s.b)((function(){return x(e.data.fillbars.top/e.data.fillbars.max)}))}),[]);var O=Object(i.useState)(e.data.isGameOver),S=Object(u.a)(O,2),j=S[0],E=S[1];Object(i.useEffect)((function(){return Object(s.b)((function(){return E(e.data.isGameOver)}))}),[]);var C,k=window.innerWidth-100,A=b(t.colors.top);return a.a.createElement("div",null,j&&a.a.createElement(m,{data:t}),a.a.createElement("div",{style:Object(d.a)({},w,{pointerEvents:"none",opacity:.75,top:"25%",textAlign:"center",color:A,width:"100%"})},(C=c)>9?C:"0".concat(C)),a.a.createElement("div",{style:{position:"fixed",top:8,height:16,left:50+(k-k*g)/2,width:g*k,backgroundColor:A}}),!j&&!y.isMobile&&a.a.createElement(v,{title:"BACK",onClick:function(){console.log("BACK"),e.data.gameState=r.intro},style:{margin:"8px",left:0,width:"calc(100% - 16px)",height:"32px",position:"fixed",bottom:0},textStyle:{fontSize:"16pt"}}))},O=function(e){var t=e.data;return a.a.createElement("div",{style:{height:"".concat(window.innerHeight,"px"),width:"".concat(window.innerWidth,"px"),display:"grid",gridTemplateRows:"1fr 1fr 1fr",gridTemplateColumns:"1fr"}},a.a.createElement("div",{style:{gridRow:1,gridColumn:1,alignSelf:"center",justifySelf:"center",fontWeight:600,color:"red",fontSize:"28pt"}},"GAME OVER"),a.a.createElement("div",{style:{gridRow:2,gridColumn:1,alignSelf:"center",justifySelf:"center"}},a.a.createElement(v,{title:"AGAIN!",onClick:function(){t.actions.startGame&&t.actions.startGame()}})),a.a.createElement("div",{style:{gridRow:3,gridColumn:1,alignSelf:"center",justifySelf:"center"}},a.a.createElement(v,{title:"BACK",onClick:function(){t.actions.reset&&t.actions.reset(),t.gameState=r.lobby}})))},S={textShadow:"-1px -1px 0 #000,1px -1px 0 #000,-1px 1px 0 #000,1px 1px 0 #000",position:"fixed",fontSize:"24pt"},j=function(e){var t=e.data,n=Object(i.useState)(e.data.score.bottom),r=Object(u.a)(n,2),o=r[0],c=r[1],l=Object(i.useState)(e.data.score.top),f=Object(u.a)(l,2),h=f[0],p=f[1];Object(i.useEffect)((function(){return Object(s.b)((function(){return c(e.data.score.bottom)}))}),[e.data.score.bottom]),Object(i.useEffect)((function(){return Object(s.b)((function(){return p(e.data.score.top)}))}),[e.data.score.top]);var g=Object(i.useState)(e.data.fillbars.bottom/e.data.fillbars.max),v=Object(u.a)(g,2),m=v[0],y=v[1],w=Object(i.useState)(e.data.fillbars.top/e.data.fillbars.max),x=Object(u.a)(w,2),j=x[0],E=x[1];Object(i.useEffect)((function(){return Object(s.b)((function(){return y(e.data.fillbars.bottom/e.data.fillbars.max)}))}),[e.data.fillbars.bottom,e.data.fillbars.max]),Object(i.useEffect)((function(){return Object(s.b)((function(){return E(e.data.fillbars.top/e.data.fillbars.max)}))}),[e.data.fillbars.top,e.data.fillbars.max]);var C=Object(i.useState)(e.data.isGameOver),k=Object(u.a)(C,2),A=k[0],T=k[1];Object(i.useEffect)((function(){return Object(s.b)((function(){return T(e.data.isGameOver)}))}),[]);var P=Object(i.useState)(b(t.colors.top)),M=Object(u.a)(P,2),D=M[0],R=M[1];Object(i.useEffect)((function(){return Object(s.b)((function(){return R(b(t.colors.top))}))}),[]);var N=Object(i.useState)(b(t.colors.bottom)),q=Object(u.a)(N,2),G=q[0],H=q[1];Object(i.useEffect)((function(){return Object(s.b)((function(){return H(b(t.colors.bottom))}))}),[]);var B=function(e){return e>9?e:"0".concat(e)},z=window.innerWidth-120;return a.a.createElement("div",null,A&&a.a.createElement(O,{data:t}),a.a.createElement("div",{style:Object(d.a)({},S,{top:4,left:4,color:D})},B(h)),a.a.createElement("div",{style:{position:"fixed",top:8,height:16,left:90,width:j*z,backgroundColor:D}}),a.a.createElement("div",{style:Object(d.a)({},S,{bottom:4,right:4,color:G})},B(o)),a.a.createElement("div",{style:{position:"fixed",bottom:8,height:16,right:90,width:m*z,backgroundColor:G}}))},E=function(e){var t=e.data,n=Object(i.useState)(t.gameState===r.intro),o=Object(u.a)(n,2),c=o[0],d=o[1];return Object(i.useEffect)((function(){return Object(s.b)((function(){t.gameState===r.intro!==c&&d(t.gameState===r.intro)}))}),[t.gameState]),c?a.a.createElement("div",{style:{height:"".concat(window.innerHeight,"px"),width:"".concat(window.innerWidth,"px"),display:"grid",gridTemplateRows:"1fr 1fr 1fr 1fr",gridTemplateColumns:"1fr",backgroundColor:"black"}},a.a.createElement("div",{style:{gridRow:1,gridColumn:1,alignSelf:"center",justifySelf:"center",fontWeight:600,color:"#80c0ff",fontSize:"28pt"}},"SKEDADDLE"),a.a.createElement("div",{style:{gridRow:2,gridColumn:1,alignSelf:"center",justifySelf:"center"}},a.a.createElement(v,{title:"PRACTICE",onClick:function(){t.gameState=r.practice}})),a.a.createElement("div",{style:{gridRow:3,gridColumn:1,alignSelf:"center",justifySelf:"center"}},a.a.createElement(v,{title:"DUEL!",onClick:function(){t.gameState=r.lobby}})),a.a.createElement("div",{style:{gridRow:4,gridColumn:1,alignSelf:"center",justifySelf:"center"}},a.a.createElement(v,{title:"WHAT?",onClick:function(){t.gameState=r.about}}))):null},C=function(e){return a.a.createElement("div",{style:{height:"".concat(window.innerHeight,"px"),width:"".concat(window.innerWidth,"px"),display:"grid",gridTemplateRows:"100px 1fr 1fr 1fr 1fr",gridTemplateColumns:"1fr",backgroundColor:"black"}},a.a.createElement("div",{style:{gridRow:1,gridColumn:1,alignSelf:"end",justifySelf:"center",fontWeight:600,color:"#80c0ff",fontSize:"28pt"}},"SKEDADDLE"),a.a.createElement("div",{style:{gridRow:2,gridColumn:1,alignSelf:"center",justifySelf:"center"}},a.a.createElement("div",{style:{gridRow:1,gridColumn:1,alignSelf:"center",justifySelf:"center",fontWeight:400,color:"white",fontSize:"16pt",textAlign:"center",whiteSpace:"pre-line",paddingLeft:"8px",paddingRight:"8px"}},"a 2-player game by \n                    \n                    ",a.a.createElement("span",{style:{fontSize:"20pt",color:"#80ff80"}},"Alex Tavor"))),a.a.createElement("div",{style:{gridRow:3,gridColumn:1,alignSelf:"center",justifySelf:"center"}},a.a.createElement("div",{style:{gridRow:1,gridColumn:1,alignSelf:"center",justifySelf:"center",fontWeight:400,color:"white",fontSize:"20pt",textAlign:"center",whiteSpace:"pre-line",paddingRight:"8px",paddingLeft:"8px"}},"Duel by pushing things with your finger!")),a.a.createElement("div",{style:{gridRow:4,gridColumn:1,alignSelf:"center",justifySelf:"center"}},a.a.createElement("div",{style:{gridRow:1,gridColumn:1,alignSelf:"center",justifySelf:"center",fontWeight:400,color:"white",fontSize:"22pt",textAlign:"center",whiteSpace:"pre-line",paddingRight:"8px",paddingLeft:"8px"}},"Tell your friends!")),a.a.createElement("div",{style:{gridRow:5,gridColumn:1,alignSelf:"center",justifySelf:"center"}},a.a.createElement(v,{title:"BACK",onClick:function(){e.data.gameState=r.intro}})))},k=function e(t){return t?(t^16*Math.random()>>t/4).toString(16):("".concat(1e7)+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,e)},A=n(12),T=n.n(A),P=n(13),M=n(26),D=n.n(M),R=function(e){if(!e.lobbyState){var t=Object(s.c)({peer:"",status:"peerless",ownId:k(),ownPeerData:{isReady:!1,nodesTouched:[]},otherPeerData:{isReady:!1,nodesTouched:[]}}),n=function(e){var t,n=e.state,r=e.onData,i=e.onConnection,a=!1,o=new D.a(n.ownId);return o.on("connection",(function(e){n.status="connected";var t=e.send.bind(e);i({send:t,peer:e.peer}),e.on("data",r)})),o.on("open",(function(){a=!0,t&&t()})),function(){var e=Object(P.a)(T.a.mark((function e(c){var s;return T.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.status="connecting",e.next=3,new Promise((function(e,s){var u=function(){var t=o.connect(c);t.on("open",(function(){n.status="connected";var a=t.send.bind(t);i({send:a,peer:t.peer}),t.on("data",r),e({send:a,peer:t.peer})}))};a?u():t=u}));case 3:s=e.sent,n.ownPeerData.isOP=!0,n.peer=s.peer,n.send=s.send,n.status="awaiting-peer-ready",n.send({isReady:!0});case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}({state:t,onConnection:function(e){t.peer=e.peer,t.send=e.send},onData:Object(s.a)((function(e){t.otherPeerData.isReady=e.isReady,t.otherPeerData.nodesTouched=e.nodesTouched||[],t.otherPeerData.boids=e.boids||[],t.otherPeerData.score=e.score,t.otherPeerData.isGameOver=e.isGameOver}))});t.connectTo=n,e.lobbyState=t}return e.lobbyState},N={gridColumn:1,placeSelf:"center center",fontWeight:400,color:"white",fontSize:"16pt",textAlign:"center",whiteSpace:"pre-line",paddingRight:"8px",paddingLeft:"8px",paddingBottom:"8px"},q=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return{height:"100%",gridRow:e,gridColumn:1,placeSelf:"center center",display:"grid"}},G=function(e){var t=e.data,n=R(e.data),o=Object(i.useState)(n.peer),c=Object(u.a)(o,2),l=c[0],f=c[1];Object(i.useEffect)((function(){return Object(s.b)((function(){f(n.peer)}))}),[]);var h=Object(i.useState)(n.status),p=Object(u.a)(h,2),g=p[0],b=p[1];Object(i.useEffect)((function(){return Object(s.b)((function(){b(n.status)}))}),[]);return a.a.createElement("div",{style:{height:"".concat(window.innerHeight,"px"),width:"".concat(window.innerWidth,"px"),display:"grid",gridTemplateRows:"1fr 1fr 1fr 1fr 1fr",gridTemplateColumns:"1fr",backgroundColor:"black"}},a.a.createElement("div",{style:{gridRow:1,gridColumn:1,placeSelf:"center center",fontWeight:600,color:"#80c0ff",textShadow:"-1px -1px 0 #000,1px -1px 0 #000,-1px 1px 0 #000,1px 1px 0 #000",fontSize:"32pt"}},"LOBBY"),a.a.createElement("div",{style:q(2)},a.a.createElement("div",{style:N,onClick:function(){return function(e){var t=document.createElement("textarea");t.value=e,t.setAttribute("readonly",""),t.style.position="absolute",t.style.left="-9999px",document.body.appendChild(t);var n=document.getSelection().rangeCount>0&&document.getSelection().getRangeAt(0);t.select(),document.execCommand("copy"),document.body.removeChild(t),n&&(document.getSelection().removeAllRanges(),document.getSelection().addRange(n))}(n.ownId)}},a.a.createElement("div",{style:{color:"#80ff80"}},"Your key, tap to copy it"),a.a.createElement("div",{style:{paddingTop:"32px"}},n.ownId))),a.a.createElement("div",{style:q(3)},a.a.createElement("div",{style:Object(d.a)({},N,{color:"#80ff80"}),onClick:function(){return navigator.clipboard.readText().then((function(e){return f(e)}))}},"Tap to paste key from clipboard")),a.a.createElement("div",{style:q(4)},a.a.createElement("input",{type:"text",onChange:function(e){return f(e.target.value)},value:l,style:Object(d.a)({},N,{color:"black",height:"32px",width:"340px"})}),function(e){var t=e.data,n=e.friendKey,o=e.status,c=R(t);Object(i.useEffect)((function(){return Object(s.b)((function(){c.otherPeerData.isReady&&"awaiting-peer-ready"===c.status&&(t.gameState=r.duel)}))}),[]);var u=null;switch(o){case"peerless":u=a.a.createElement(v,Object.assign({style:{marginTop:"32px",placeSelf:"center center"}},{disabled:!Boolean(n),title:"JOIN",onClick:Object(s.a)(Object(P.a)(T.a.mark((function e(){return T.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:c.connectTo&&c.connectTo(n);case 1:case"end":return e.stop()}}),e)}))))}));break;case"connecting":u=a.a.createElement(v,Object.assign({style:{marginTop:"32px",placeSelf:"center center"}},{disabled:!0,title:"CONNECTING"}));break;case"connected":u=a.a.createElement(v,Object.assign({style:{marginTop:"32px",placeSelf:"center center"}},{title:"DUEL!",onClick:function(){var e=Object(P.a)(T.a.mark((function e(){return T.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:c.connectTo&&(console.log(c.send?"sending is ready true":"no send found"),c.send&&c.send({isReady:!0}),t.gameState=r.duel);case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()}));break;case"awaiting-peer-ready":u=a.a.createElement(v,Object.assign({style:{marginTop:"32px",placeSelf:"center center"}},{disabled:!0,title:"WAITING"}))}return u}({data:t,friendKey:l,status:g})),a.a.createElement("div",{style:q(5)},a.a.createElement(v,{style:{placeSelf:"center center"},title:"BACK",onClick:function(){t.gameState=r.intro}})))},H=function(e){var t,n=Object(i.useState)(e.gameState.gameState),o=Object(u.a)(n,2),c=o[0],d=o[1];switch(Object(i.useEffect)((function(){return Object(s.b)((function(){return d(e.gameState.gameState)}))}),[]),c){case r.practice:t=a.a.createElement(x,{data:e.gameState});break;case r.duel:t=a.a.createElement(j,{data:e.gameState});break;case r.intro:t=a.a.createElement(E,{data:e.gameState});break;case r.about:t=a.a.createElement(C,{data:e.gameState});break;case r.lobby:t=a.a.createElement(G,{data:e.gameState})}return a.a.createElement("div",{style:{position:"fixed"}},t)},B=function(e){var t=Object(i.useState)(e.data.isGameOver),n=Object(u.a)(t,2),o=n[0],c=n[1];Object(i.useEffect)((function(){return Object(s.b)((function(){return c(e.data.isGameOver)}))}),[e.data.isGameOver]);var d=Object(i.useState)(e.data.gameState===r.duel),l=Object(u.a)(d,2),f=l[0],h=l[1];Object(i.useEffect)((function(){return Object(s.b)((function(){return h(e.data.gameState===r.duel)}))}),[e.data.gameState]);var p=Math.ceil(e.data.maxDuration-e.data.duration),g=Object(i.useState)(Math.max(0,p)),b=Object(u.a)(g,2),v=b[0],m=b[1];return Object(i.useEffect)((function(){return Object(s.b)((function(){if(f&&!o){var t=Math.ceil(e.data.maxDuration-e.data.duration);m(Math.max(0,t)),t<=0&&e.data.actions.endGame&&e.data.actions.endGame()}}))}),[f,o]),!f||o?null:a.a.createElement("div",{style:{position:"absolute",height:"".concat(window.innerHeight,"px"),width:"".concat(window.innerWidth,"px"),display:"grid",gridTemplateRows:"1fr",gridTemplateColumns:"1fr",pointerEvents:"none",touchAction:"none"}},a.a.createElement("div",{style:{alignSelf:"center",justifySelf:"center",textAlign:"center",fontWeight:600,color:"#ffff80",fontSize:"64pt",pointerEvents:"none",touchAction:"none"}},v))};function z(e){var t=0;return function n(){t=window.requestAnimationFrame(n),e()}(),function(){window.cancelAnimationFrame(t)}}var W=Date.now();function I(e,t){!function(e){z((function(){var t=Date.now(),n=(t-W)/1e3;W=t,e(n)}))}((function(n){t(n*e.speed)}))}var L=n(15),_=n(1);function V(e,t){arguments.length>2&&void 0!==arguments[2]&&arguments[2];var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:200,r=new _.ParticleContainer(n,{uvs:!0,tint:!0,position:!0,rotation:!0,vertices:!0}),i=Array.from({length:t},(function(){var t=new _.Sprite(e);return r.addChild(t),t.tint=parseInt(l(),16),t}));return{view:r,sprites:i}}var F=n(18);function K(e){var t=e.display,n=e.grid,r=e.boids,i=e.colors,a=e.actions,o=Array.from({length:22},(function(e,t){return 53+t})),c=Array.from({length:22},(function(e,t){return 1226+t})),s=[].concat(Object(L.a)(o),Object(L.a)(c)),u=V(t.hexTexture,o.length+c.length);t.camera.addChild(u.view);var d=V(t.hexTexture,o.length+c.length);t.camera.addChild(d.view);var l=d.sprites;u.sprites.forEach((function(e,t){e.tint=t<o.length?i.top:i.bottom;var r=n.getPosAtNode(s[t]);e.position.set(r.x,r.y),e.scale.set(1,1);var a=l[t];a.tint=t<o.length?i.top:i.bottom,a.position.set(r.x+a.width/2,r.y+a.height/2),a.scale.set(1,1),a.anchor.set(.5,.5)}));return{top:o,bottom:c,all:s,views:u,update:function(e){r.boids.forEach((function(e){var t=s.indexOf(e.node);-1!==t&&(r.removeBoid(e),function(e){var t=e.sprite,n=e.duration,r=void 0===n?300:n;F.autoPlay(!0),t.scale.set(1,1),t.alpha=1,new F.Tween({scale:1,alpha:1}).to({scale:6,alpha:0},r).start().easing(F.Easing.Quadratic.Out).on("update",(function(e){t.scale.set(e.scale,e.scale),t.alpha=e.alpha}))}({sprite:l[t]}),t<o.length?a.onTopScored():a.onBottomScored())}))}}}var U=!1;function J(e,t,n,r,i,a){!function(e,t,n){var r=.75*t.gridLayout.hexSize;e.camera.on("clicked",(function(e){var i=t.getHexIdByPixel({x:e.world.x-r,y:e.world.y-r});n(i)}))}(e,t,r),function(e,t,n,r,i){var a=.75*t.gridLayout.hexSize,o=function(e){return t.getHexIdByPixel({x:e.x-a,y:e.y-a})};e.camera.on("drag-start",(function(e){U=!0,n(o(e.world))})),e.camera.on("drag-end",(function(e){U=!1,r(o(e.world))})),e.camera.on("touchmove",(function(t){var n=t.data.global,r=o(e.camera.toWorld(n.x,n.y));isNaN(r)||i(r)})),document.addEventListener("mousemove",(function(t){if(U){var n=o(e.camera.toWorld(t.x,t.y));isNaN(n)||i(n)}}))}(e,t,i,a,n)}function Y(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=0,i=function(i){return r+=i,e.scentGrid[t]=Math.max(0,e.scentGrid[t]+e.quantity),r<n};return i}var Q=n(4),Z=n(5),$=function(e,t){if(ee(e)>t){var n=te(e);return ne(n,t)}return e},X=function(e,t){var n=e.x-t.x,r=e.y-t.y;return n*n+r*r},ee=function(e){return Math.sqrt(e.x*e.x+e.y*e.y)},te=function(e){var t=ee(e);return t>0?ne(e,1/t):e},ne=function(e,t){return e.x*=t,e.y*=t,e},re=function(e,t){return e.x/=t,e.y/=t,e},ie=function(e,t){return e.x+=t.x,e.y+=t.y,e},ae=function(e,t){return e.x-=t.x,e.y-=t.y,e};function oe(e){return Object(d.a)({},{position:{x:0,y:0},velocity:{x:0,y:0},drag:.1,speed:1,thrust:10,radius:1},{},e)}function ce(e,t){var n={x:0,y:0},r=t.length;if(!r)return{x:0,y:0};var i=!0,a=!1,o=void 0;try{for(var c,s=t[Symbol.iterator]();!(i=(c=s.next()).done);i=!0){var u=c.value,l=X(e.position,u)||Math.random(),f=ae(Object(d.a)({},e.position),u);te(f),re(f,l),ie(n,f)}}catch(h){a=!0,o=h}finally{try{i||null==s.return||s.return()}finally{if(a)throw o}}return re(n,r),ee(n)>0&&(te(n),ne(n,e.speed),ae(n,e.velocity),$(n,e.thrust)),n}function se(e,t){var n={x:0,y:0},r=t.length;if(!r)return{x:0,y:0};var i=!0,a=!1,o=void 0;try{for(var c,s=t[Symbol.iterator]();!(i=(c=s.next()).done);i=!0){var u=c.value;ie(n,u)}}catch(l){a=!0,o=l}finally{try{i||null==s.return||s.return()}finally{if(a)throw o}}return function(e,t){var n=ae(Object(d.a)({},e),t.position);return te(n),ne(n,t.speed),ae(n,t.velocity),$(n,t.thrust),n}(re(n,r),e)}function ue(e,t){ie(e,t)}function de(e,t){var n=function(e,t){var n=Math.cos(t),r=Math.sin(t);return e.x=e.x*n-e.y*r,e.y=e.x*r+e.y*n,e}(Object(d.a)({},e.velocity),t);return te(n),ne(n,e.speed),ae(n,e.velocity),$(n,e.thrust),n}var le=function(){function e(t,n,r,i,a){Object(Q.a)(this,e),this.boidTemplate=t,this.grid=n,this.display=r,this.walls=i,this.scentToAvoid=a,this.boids=void 0,this.boidViews=void 0,this.occupiableNodes=void 0,this.numNodes=void 0,this.initialize()}return Object(Z.a)(e,[{key:"reset",value:function(){if(this.boidViews&&this.boidViews.length){var e=this.boidViews[0].parent;e.parent&&e.parent.removeChild(e)}this.initialize()}},{key:"update",value:function(e){this.updateBoids(e),this.updateViews(e)}},{key:"addBoid",value:function(e){var t=oe(this.boidTemplate);return this.boids.push(t),t.position=Object(d.a)({},e),t.node=this.grid.getHexIdByPixel(t.position),t}},{key:"addBoidAtNode",value:function(e){var t=oe(this.boidTemplate);return this.boids.push(t),t.node=e,t.position=this.grid.getPosAtNode(e),t}},{key:"removeBoid",value:function(e){e?this.boids.splice(this.boids.indexOf(e),1):this.boids.pop()}},{key:"syncBoid",value:function(e,t){var n=this.boids[t];n.position.x=e.position.x,n.position.y=e.position.y,n.velocity.x=e.velocity.x,n.velocity.y=e.velocity.y,n.node=this.grid.getHexIdByPixel(n.position)}},{key:"updateViews",value:function(e){var t=this,n=this.boids.length;this.boidViews.forEach((function(e,r){if(e.alpha=r<n?1:0,e.alpha){var i=t.boids[r];e.tint=t.boidTemplate.hue,e.position.set(i.position.x,i.position.y),e.scale.x!==i.radius&&e.scale.set(i.radius,i.radius)}}))}},{key:"updateBoids",value:function(e){var t=this;this.boids.forEach((function(n){if(!(n.node<0||n.node>=t.numNodes)){var r=t.grid.getHexIdByPixel(n.position);if(!isNaN(r)){var i=t.occupiableNodes;n.node&&i[n.node].delete(n),n.node=r;var a=t.grid.gridArr[n.node].neighbors.filter((function(e){return!isNaN(e)})),o=a.filter((function(e){return!t.walls[e]})).map((function(e){return t.grid.gridArr[e].position})),c=0,s=null,u=!0,l=!1,f=void 0;try{for(var h,p=a[Symbol.iterator]();!(u=(h=p.next()).done);u=!0){var g=h.value,b=t.scentToAvoid.scentGrid[g];b>c&&b>n.olfaction&&(c=b,s=Object(d.a)({},t.grid.gridArr[g].position))}}catch(w){l=!0,f=w}finally{try{u||null==p.return||p.return()}finally{if(l)throw f}}var v=s?[s]:[],m=t.boids.filter((function(e){return X(e.position,n.position)<=1e3})),y=function(e,t){var n={x:0,y:0},r=!0,i=!1,a=void 0;try{for(var o,c=t[Symbol.iterator]();!(r=(o=c.next()).done);r=!0){ue(n,o.value)}}catch(w){i=!0,a=w}finally{try{r||null==c.return||c.return()}finally{if(i)throw a}}return re(n,t.length),n}(0,[ne(ce(n,o),100*t.boidTemplate.weights.avoidObstacles),ne(ce(n,m.map((function(e){return e.position}))),t.boidTemplate.weights.separation),ne(ce(n,v),t.boidTemplate.weights.avoidScent),ne(se(n,m.map((function(e){return e.position}))),t.boidTemplate.weights.cohesion),ne(de(n,0+Math.random()>.95?Math.floor(180*Math.random()-90):0),4)]);fe(y,n,e||1),i[n.node].add(n)}}}))}},{key:"initialize",value:function(){var e,t;this.boids=(e=0,t=this.boidTemplate,Array.from({length:e},(function(e){return oe(t)})));var n=V(this.display.hexTexture,200);this.display.camera.addChild(n.view),this.boidViews=n.sprites,this.occupiableNodes=Array.from(this.grid.gridArr,(function(e){return new Set})),this.numNodes=this.grid.gridArr.length}}]),e}(),fe=function(e,t,n){te(e),ne(e,t.thrust),ie(t.velocity,e),$(t.velocity,t.speed);var r=ne(Object(d.a)({},t.velocity),n);ie(t.position,r),ne(t.velocity,t.drag)},he={drag:.999,speed:150,thrust:10,radius:1,olfaction:.001,hue:16744703,weights:{separation:11,cohesion:4,seekScent:6,avoidScent:8,avoidObstacles:12,alignment:1}},pe=function(e){return Array.from({length:11},(function(t,n){return e.addBoidAtNode(589+2*n),e.addBoidAtNode(640+2*n),e.addBoidAtNode(691+2*n),null}))};function ge(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:14540250,r=new _.ParticleContainer(5e5,{tint:!0}),i=e.gridArr.map((function(e){var i=new _.Sprite(t);return i.position.set(e.position.x,e.position.y),r.addChild(i),i.tint=n,i.alpha=0,i}));return{view:r,nodes:i}}var be=function(e){var t=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:15,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.9,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:10,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:8454143,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:.001,o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,c=Array.from(e.gridArr,(function(e){return 0})),s=Array.from(e.gridArr,(function(e){return 1}));return{scentGrid:c,permeability:s,id:k(),spread:t,evaporation:n,quantity:r,hue:i,minValue:a,seconds:o}}(e.grid),n=ge(e.grid,e.display.hexTexture,t.hue);e.display.camera.addChild(n.view);var r,i,a,o,c=(r=e.grid,i=e.walls,a=t,o=t.scentGrid,function(e){for(var t=0;t<o.length;t++){var n=i[t];if(!isNaN(n)&&n){var c=r.gridArr[t].neighbors,s=o[t];if(!isNaN(s)&&a){var u=c.filter((function(e){return!isNaN(i[e])&&i[e]})),d=s*Math.min(1,a.spread*e),l=d/u.length*a.evaporation,f=!0,h=!1,p=void 0;try{for(var g,b=u[Symbol.iterator]();!(f=(g=b.next()).done);f=!0){var v=g.value,m=l*i[v];o[v]+=m}}catch(y){h=!0,p=y}finally{try{f||null==b.return||b.return()}finally{if(h)throw p}}o[t]=o[t]-d}else o[t]=0}else o[t]=0}a.scentGrid.forEach((function(e,t){var n=o[t];a.scentGrid[t]=n>=a.minValue?n:0}))}),s=function(e,t){var n=(t.quantity+t.minValue)/20;return function(r){e.forEach((function(e,r){e.tint=t.hue,e.alpha=Math.min(.75,Math.min(n,t.scentGrid[r])/n)}))}}(n.nodes,t);return{data:t,display:n,update:function(e){c(e),s(e)}}};var ve=function e(t,n){Object(Q.a)(this,e),this.x=t,this.y=n},me=function(){function e(t,n,r){if(Object(Q.a)(this,e),this.q=t,this.r=n,this.s=r,this.n8s=void 0,this.roundHex=void 0,0!==Math.round(t+n+r))throw new Error("q + r + s must be 0")}return Object(Z.a)(e,null,[{key:"direction",value:function(t){return e.directions[t]}}]),Object(Z.a)(e,[{key:"add",value:function(t){return new e(this.q+t.q,this.r+t.r,this.s+t.s)}},{key:"subtract",value:function(t){return new e(this.q-t.q,this.r-t.r,this.s-t.s)}},{key:"scale",value:function(t){return new e(this.q*t,this.r*t,this.s*t)}},{key:"rotateLeft",value:function(){return new e(-this.s,-this.q,-this.r)}},{key:"rotateRight",value:function(){return new e(-this.r,-this.s,-this.q)}},{key:"neighbors",value:function(){var t=this;return this.n8s?this.n8s:(this.n8s=e.directions.map((function(e){return t.add(e)})),this.n8s)}},{key:"neighbor",value:function(e){return this.neighbors()[e]}},{key:"diagonalNeighbor",value:function(t){return this.add(e.diagonals[t])}},{key:"len",value:function(){return(Math.abs(this.q)+Math.abs(this.r)+Math.abs(this.s))/2}},{key:"distance",value:function(e){return this.subtract(e).len()}},{key:"round",value:function(){if(this.roundHex)return this.roundHex;var t=Math.round(this.q),n=Math.round(this.r),r=Math.round(this.s),i=Math.abs(t-this.q),a=Math.abs(n-this.r),o=Math.abs(r-this.s);return i>a&&i>o?t=-n-r:a>o?n=-t-r:r=-t-n,this.roundHex=new e(t,n,r),this.roundHex}},{key:"lerp",value:function(t,n){return new e(this.q*(1-n)+t.q*n,this.r*(1-n)+t.r*n,this.s*(1-n)+t.s*n)}},{key:"linedraw",value:function(t){for(var n=this.distance(t),r=new e(this.q+1e-6,this.r+1e-6,this.s-2e-6),i=new e(t.q+1e-6,t.r+1e-6,t.s-2e-6),a=[],o=1/Math.max(n,1),c=0;c<=n;c++)a.push(r.lerp(i,o*c).round());return a}},{key:"id",get:function(){return"".concat(this.q," ").concat(this.r," ").concat(this.s)}}]),e}();me.directions=[new me(1,0,-1),new me(1,-1,0),new me(0,-1,1),new me(-1,0,1),new me(-1,1,0),new me(0,1,-1)],me.diagonals=[new me(2,-1,-1),new me(1,-2,1),new me(-1,-1,2),new me(-2,1,1),new me(-1,2,-1),new me(1,1,-2)];var ye=function(){function e(t,n){Object(Q.a)(this,e),this.col=t,this.row=n}return Object(Z.a)(e,null,[{key:"qoffsetFromCube",value:function(t,n){return new e(n.q,n.r+(n.q+t*(1&n.q))/2)}},{key:"qoffsetToCube",value:function(e,t){var n=t.col,r=t.row-(t.col+e*(1&t.col))/2;return new me(n,r,-n-r)}},{key:"roffsetFromCube",value:function(t,n){return new e(n.q+(n.r+t*(1&n.r))/2,n.r)}},{key:"roffsetToCube",value:function(e,t){var n=t.col-(t.row+e*(1&t.row))/2,r=t.row;return new me(n,r,-n-r)}}]),e}();ye.EVEN=1,ye.ODD=-1;var we=function(){function e(t,n){Object(Q.a)(this,e),this.col=t,this.row=n}return Object(Z.a)(e,null,[{key:"qdoubledFromCube",value:function(t){return new e(t.q,2*t.r+t.q)}},{key:"rdoubledFromCube",value:function(t){return new e(2*t.q+t.r,t.r)}}]),Object(Z.a)(e,[{key:"qdoubledToCube",value:function(){var e=this.col,t=(this.row-this.col)/2;return new me(e,t,-e-t)}},{key:"rdoubledToCube",value:function(){var e=(this.col-this.row)/2,t=this.row;return new me(e,t,-e-t)}}]),e}(),xe=function e(t,n,r,i,a,o,c,s,u){Object(Q.a)(this,e),this.f0=t,this.f1=n,this.f2=r,this.f3=i,this.b0=a,this.b1=o,this.b2=c,this.b3=s,this.startAngle=u},Oe=function(){function e(t,n,r){Object(Q.a)(this,e),this.orientation=t,this.size=n,this.origin=r}return Object(Z.a)(e,[{key:"hexToPixel",value:function(e){var t=this.orientation,n=this.size,r=this.origin,i=(t.f0*e.q+t.f1*e.r)*n.x,a=(t.f2*e.q+t.f3*e.r)*n.y;return new ve(i+r.x,a+r.y)}},{key:"pixelToHex",value:function(e){var t=this.orientation,n=this.size,r=this.origin,i=new ve((e.x-r.x)/n.x,(e.y-r.y)/n.y),a=t.b0*i.x+t.b1*i.y,o=t.b2*i.x+t.b3*i.y;return new me(a,o,-a-o)}},{key:"hexCornerOffset",value:function(e){var t=this.orientation,n=this.size,r=2*Math.PI*(t.startAngle-e)/6;return new ve(n.x*Math.cos(r),n.y*Math.sin(r))}},{key:"polygonCorners",value:function(e){for(var t=[],n=this.hexToPixel(e),r=0;r<6;r++){var i=this.hexCornerOffset(r);t.push(new ve(n.x+i.x,n.y+i.y))}return t}}]),e}();Oe.pointy=new xe(Math.sqrt(3),Math.sqrt(3)/2,0,1.5,Math.sqrt(3)/3,-1/3,0,2/3,.5),Oe.flat=new xe(1.5,0,Math.sqrt(3)/2,Math.sqrt(3),2/3,0,-1/3,Math.sqrt(3)/3,0);var Se=function(e){return Array.from(new Set([].concat.apply([],e.neighbors().map((function(e){return e.neighbors()})))))},je=function(){function e(t){var n=this;Object(Q.a)(this,e),this.gridLayout=t,this.gridArr=void 0,this.edges=void 0,this.gridHash=void 0,this._layout=void 0,this._hexes=void 0,this._hexes=function(e,t,n,r){for(var i=[],a=n;a<=r;a++)for(var o=e+(1&a);o<=t;o+=2){var c=new we(o,a).rdoubledToCube();i.push(c)}return i}(0,t.columns,0,t.rows),console.log("gid with ".concat(this._hexes.length," hexes"));var r=this._hexes.reduce((function(e,t,n){return e[t.id]=n,e}),{});this._layout=new Oe(Oe.pointy,{x:t.hexSize,y:t.hexSize},{x:0,y:0}),this.gridHash={},this.gridArr=this._hexes.map((function(e,t){var i={id:e.id,neighbors:e.neighbors().map((function(e){return r[e.id]})),neighbors2:Se(e).map((function(e){return r[e.id]})).filter((function(t){return String(t)!==String(e.id)})),position:n._layout.hexToPixel(e)};return n.gridHash[i.id]=t,i})),this.edges=this.gridArr.reduce((function(e,t,n){return-1!==t.neighbors.findIndex((function(e){return"undefined"===typeof e}))&&e.push(n),e}),new Array)}return Object(Z.a)(e,[{key:"getHexShape",value:function(){return this._layout.polygonCorners(this._hexes[0])}},{key:"getHexPosAtPixel",value:function(e){return this._layout.hexToPixel(this._layout.pixelToHex(e))}},{key:"getPosAtNode",value:function(e){var t=this.gridArr[e];if(!t)throw new Error("Node ".concat(e," not found"));return Object(d.a)({},t.position)}},{key:"getHexIdByPixel",value:function(e){var t=this._layout.pixelToHex(e).round();return this.gridHash[t.id]}}]),e}();function Ee(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window.innerWidth,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window.innerHeight,n=new _.Application({width:e,height:t,transparent:!0});return n}function Ce(e,t){var n=new _.Graphics;n.lineStyle(1,16777215),n.beginFill(16777215);var r=e.getHexShape().map((function(e){return new _.Point(e.x,e.y)})),i=new _.Polygon(r);return n.drawPolygon(i),n.endFill(),t.renderer.generateTexture(n,_.SCALE_MODES.NEAREST,1)}var ke=n(28);function Ae(e,t,n){var r=t.gridArr[t.gridArr.length-1],i=r.position.y+2*n,a=r.position.x+2*n,o=function(e,t,n){var r=new ke.a({screenWidth:window.innerWidth,screenHeight:window.innerHeight,worldWidth:t,worldHeight:n});return e.stage.addChild(r),r}(e,a,i).drag().clamp({direction:"all",underflow:"center"}).clampZoom({minWidth:a,minHeight:i});return o.position.set(a/2,i/2),o}var Te=function(){function e(t,n,r){Object(Q.a)(this,e),this.x=t,this.y=n,this.z=r}return Object(Z.a)(e,[{key:"dot2",value:function(e,t){return this.x*e+this.y*t}},{key:"dot3",value:function(e,t,n){return this.x*e+this.y*t+this.z*n}}]),e}(),Pe=[new Te(1,1,0),new Te(-1,1,0),new Te(1,-1,0),new Te(-1,-1,0),new Te(1,0,1),new Te(-1,0,1),new Te(1,0,-1),new Te(-1,0,-1),new Te(0,1,1),new Te(0,-1,1),new Te(0,1,-1),new Te(0,-1,-1)],Me=[151,160,137,91,90,15,131,13,201,95,96,53,194,233,7,225,140,36,103,30,69,142,8,99,37,240,21,10,23,190,6,148,247,120,234,75,0,26,197,62,94,252,219,203,117,35,11,32,57,177,33,88,237,149,56,87,174,20,125,136,171,168,68,175,74,165,71,134,139,48,27,166,77,146,158,231,83,111,229,122,60,211,133,230,220,105,92,41,55,46,245,40,244,102,143,54,65,25,63,161,1,216,80,73,209,76,132,187,208,89,18,169,200,196,135,130,116,188,159,86,164,100,109,198,173,186,3,64,52,217,226,250,124,123,5,202,38,147,118,126,255,82,85,212,207,206,59,227,47,16,58,17,182,189,28,42,223,183,170,213,119,248,152,2,44,154,163,70,221,153,101,155,167,43,172,9,129,22,39,253,19,98,108,110,79,113,224,232,178,185,112,104,218,246,97,228,251,34,242,193,238,210,144,12,191,179,162,241,81,51,145,235,249,14,239,107,49,192,214,31,181,199,106,157,184,84,204,176,115,121,50,45,127,4,150,254,138,236,205,93,222,114,67,29,24,72,243,141,128,195,78,66,215,61,156,180],De=new Array(512),Re=new Array(512),Ne=(Math.sqrt(3),Math.sqrt(3),1/6),qe=function(e,t,n){var r,i,a,o,c,s,u=(e+t+n)*(1/3),d=Math.floor(e+u),l=Math.floor(t+u),f=Math.floor(n+u),h=(d+l+f)*Ne,p=e-d+h,g=t-l+h,b=n-f+h;p>=g?g>=b?(r=1,i=0,a=0,o=1,c=1,s=0):p>=b?(r=1,i=0,a=0,o=1,c=0,s=1):(r=0,i=0,a=1,o=1,c=0,s=1):g<b?(r=0,i=0,a=1,o=0,c=1,s=1):p<b?(r=0,i=1,a=0,o=0,c=1,s=1):(r=0,i=1,a=0,o=1,c=1,s=0);var v=p-r+Ne,m=g-i+Ne,y=b-a+Ne,w=p-o+2*Ne,x=g-c+2*Ne,O=b-s+2*Ne,S=p-1+.5,j=g-1+.5,E=b-1+.5,C=Re[(d&=255)+De[(l&=255)+De[f&=255]]],k=Re[d+r+De[l+i+De[f+a]]],A=Re[d+o+De[l+c+De[f+s]]],T=Re[d+1+De[l+1+De[f+1]]],P=.6-p*p-g*g-b*b,M=.6-v*v-m*m-y*y,D=.6-w*w-x*x-O*O,R=.6-S*S-j*j-E*E;return 32*((P<0?0:(P*=P)*P*C.dot3(p,g,b))+(M<0?0:(M*=M)*M*k.dot3(v,m,y))+(D<0?0:(D*=D)*D*A.dot3(w,x,O))+(R<0?0:(R*=R)*R*T.dot3(S,j,E)))};!function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;e>0&&e<1&&(e*=65536),(e=Math.floor(e))<256&&(e|=e<<8);for(var t=0;t<256;t++){var n=void 0;n=1&t?Me[t]^255&e:Me[t]^e>>8&255,De[t]=De[t+256]=n,Re[t]=Re[t+256]=Pe[n%12]}}(Math.random());var Ge,He=0,Be=Date.now();function ze(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,i=n||12*Math.sqrt(e.gridArr.length);t.forEach((function(t,n){var r=e.gridArr[n].position,a=f(g(qe(r.x/i,r.y/i,He),.5,.5));t.tint=a}));var a=Date.now();He+=r/(a-Be),Be=a}function We(e,t,n){var r=function(e){return function(t,n){var r=h(t.tint),i=function(e,t,n){e/=255,t/=255,n/=255;var r,i,a=Math.max(e,t,n),o=Math.min(e,t,n),c=(a+o)/2;if(a===o)r=i=0;else{var s=a-o;switch(i=c>.5?s/(2-a-o):s/(a+o),a){case e:r=(t-n)/s+(t<n?6:0);break;case t:r=(n-e)/s+2;break;case n:r=(e-t)/s+4}r&&(r/=6)}return[r||0,i||0,c||0]}(r.r,r.g,r.g),a=Math.sqrt(e.distances[n]/e.maxDist);i[0]=a,i[1]=i[2]=.5;var o=f(g.apply(void 0,Object(L.a)(i)));t.tint=o}};t.on("clicked",(function(t){var i=e.getHexPosAtPixel(t.world),a=r(function(t){var n=0,r=e.gridArr.map((function(e){var r=X(t,e.position);return r>=n&&(n=r),r}));return{maxDist:n,distances:r}}(i));n.forEach(a)}))}function Ie(e,t,n){var r=new _.ParticleContainer(5e5,{tint:!0}),i=e.gridArr.map((function(e,i){var a=new _.Sprite(n);return a.position.set(e.position.x,e.position.y),r.addChild(a),a.tint=16777088,a.alpha=Math.abs(t[i]-1),a}));return{view:r,nodes:i}}!function(e){e[e.staticNoise=0]="staticNoise",e[e.animatedNoise=1]="animatedNoise",e[e.prettyHexesClick=2]="prettyHexesClick",e[e.none=3]="none"}(Ge||(Ge={}));var Le=function(e){var t=new je({rows:50,columns:50,hexSize:10}),n=function(e){var t=e.gridArr.length,n=new Array(t).fill(1);return n.forEach((function(t,r){-1!==e.edges.indexOf(r)&&(n[r]=0)})),n}(t);return{grid:t,walls:n,display:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Ge.none,i=t.gridLayout.hexSize,a=Ee(window.innerWidth-.5*i,window.innerHeight-.5*i),o=Ce(t,a),c=ge(t,o),s=c.nodes,u=Ae(a,t,i),d=function(){return ze(t,s,t.gridArr.length/10,.01)};switch(r){case Ge.animatedNoise:z(d);break;case Ge.prettyHexesClick:We(t,u,c.nodes);break;case Ge.staticNoise:d()}u.addChild(c.view);var l=Ie(t,n,o);return u.addChild(l.view),e.appendChild(a.view),{pixi:a,bgSprites:s,camera:u,hexTexture:o,wallsSprites:l.nodes}}(e,t,n,Ge.none)}},_e=10;function Ve(e,t){var n=Le(e),i=be(n),a=function(e,t){var n=new le(he,e.grid,e.display,e.walls,t);return pe(n),n}(n,i.data),o=K({display:n.display,grid:n.grid,boids:a,colors:t.colors,actions:{onTopScored:function(){t.score.top+=1},onBottomScored:function(){t.score.bottom+=1}}}),c=function(e){var t=function(t,n){var r=t+_e*n;return r>=e.max?e.max:r};return{bars:e,update:function(n){e.top=t(e.top,n),e.bottom=t(e.bottom,n)}}}(t.fillbars),s=function(e,t,n,r){var i={updates:[]},a=!1,o=0,c=function(t){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;if(!(r.bars.top<a)){i.updates.push(Y(n,t,n.seconds)),r.bars.top=Math.max(r.bars.top-a,0);var o=e.lobbyState;o&&o.ownPeerData.nodesTouched&&o.ownPeerData.nodesTouched.push(t)}},s=function(){var e=r.bars.top/r.bars.max;o&&e>=.2&&(a=!0)};J(t.display,t.grid,(function(e){s(),o&&a&&r.bars.top>0&&(c(e),r.bars.top<=0&&(a=!1))}),(function(e){o&&r.bars.top/r.bars.max>=.001&&c(e)}),s,(function(){a=!1}));return{update:function(e){o=e,i.updates=i.updates.filter((function(t){return t(e)}))},droppers:i,dropFromPeer:function(e){e.forEach((function(e){i.updates.push(Y(n,e,n.seconds)),r.bars.bottom-=1}))}}}(t,n,i.data,c),u=function(e,t,n){return function(){var i=e.lobbyState;if(i&&e.gameState===r.duel){if(i.otherPeerData.nodesTouched&&i.otherPeerData.nodesTouched.length&&(t.dropFromPeer(i.otherPeerData.nodesTouched),i.otherPeerData.nodesTouched=[]),i.ownPeerData.isOP)i.ownPeerData.isGameOver=e.isGameOver,i.ownPeerData.score=Object(d.a)({},e.score),i.ownPeerData.boids=n.boids.map((function(e){return{position:{x:e.position.x,y:e.position.y},velocity:e.velocity}}));else{var a=Boolean(i.otherPeerData.isGameOver);if(e.isGameOver&&!a?e.actions.startGame():!e.isGameOver&&a&&e.actions.endGame(),i.otherPeerData.score&&(e.score.top=i.otherPeerData.score.top,e.score.bottom=i.otherPeerData.score.bottom),e.isGameOver)return;for(var o=i.otherPeerData.boids||n.boids;o.length!==n.boids.length;){if(o.length>n.boids.length){var c=o[n.boids.length];n.addBoid(c.position)}for(;o.length<n.boids.length;)n.boids.pop()}o.forEach((function(e,t){n.syncBoid(e,t)})),i.otherPeerData.boids=o}(i.ownPeerData.isOP||i.ownPeerData.nodesTouched&&i.ownPeerData.nodesTouched.length)&&(i.send&&i.send(i.ownPeerData),i.ownPeerData.nodesTouched=[])}}}(t,s,a);I(t.time,(function(e){o.update(e),s.update(e),i.update(e),a.update(e),c.update(e),t.duration+=e,u()}));t.actions.reset=function(){i.data.scentGrid.forEach((function(e,t){return i.data.scentGrid[t]=0})),s.droppers.updates=[],a.reset(),t.score.top=0,t.score.bottom=0,c.bars.top=c.bars.max,c.bars.bottom=c.bars.max,pe(a)}}var Fe=function(){var e=Object(i.useRef)(null),t=Object(s.c)({gameState:r.intro,score:{top:0,bottom:0},fillbars:{max:10,top:10,bottom:10},colors:{top:8454016,bottom:16744576},duration:0,maxDuration:30,time:{speed:1},isGameOver:!0});t.actions={};var n=R(t),o=Object(s.a)((function(){t.time.speed=0,t.isGameOver=!0})),c=Object(s.a)((function(){t.isGameOver=!1,t.actions.reset&&t.actions.reset(),t.time.speed=1,t.duration=t.gameState===r.duel?0:t.maxDuration}));if(t.actions.endGame=o,t.actions.startGame=c,Object(i.useEffect)((function(){e.current&&Ve(e.current,t)}),[e]),Object(i.useEffect)((function(){return Object(s.b)((function(){t.score.bottom+t.score.top>=33&&o()}))}),[]),Object(i.useEffect)((function(){return Object(s.b)((function(){return(t.gameState===r.practice||t.gameState===r.duel)&&c()}))}),[]),window.location.hash){!function(){var e=window.location.hash.substr(1);window.location.hash="",n.peer=e,n.connectTo&&n.connectTo(e),t.gameState=r.lobby}()}return a.a.createElement("div",{style:{position:"relative",backgroundColor:"black",width:"100vw",height:"100vh"}},a.a.createElement(B,{data:t}),a.a.createElement("div",{style:{position:"fixed"},ref:e}),a.a.createElement(H,{gameState:t}))};c.a.render(a.a.createElement(Fe,null),document.getElementById("root"))}},[[29,1,2]]]);
//# sourceMappingURL=main.42b6ca5d.chunk.js.map